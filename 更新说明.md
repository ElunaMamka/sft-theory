# 🎉 SFT课程系统更新说明

## ✨ 本次重大更新

### 1. 📁 代码示例系统
现在每个Part都有对应的代码示例，存放在`code/`目录下：

```
code/
├── part1/  (预训练 vs SFT)
│   ├── 01_pretraining_simulation.py       ✓ 已创建
│   ├── 02_sft_vs_pretraining.py          ✓ 已创建
│   ├── 03_data_scale_comparison.py       ✓ 已创建
│   └── README.md
│
├── part2/  (LoRA)
│   ├── 01_full_finetuning_problems.py    ✓ 已创建
│   ├── 02_lora_mechanism.py              ✓ 已创建
│   └── (更多待添加)
│
├── part3/  (数据集) - 待创建
├── part4/  (工作流) - 待创建
└── requirements.txt
```

### 2. 🎨 升级的代码展示组件

**CodeBlock** 组件现在支持：
- 📁 **文件路径显示**（紫色渐变背景，醒目）
- 🏷️ **语言标签**（Python/JavaScript等）
- 📋 **一键复制**（点击即可复制代码）
- ▶️ **可运行标识**（标记哪些代码可以直接运行）
- 💡 **代码说明**（解释代码的用途和功能）

示例效果：
```
┌────────────────────────────────────────────────┐
│ 📁 code/part1/01_pretraining_simulation.py    │ ← 文件路径
├────────────────────────────────────────────────┤
│ 预训练过程模拟      Python  📋 复制代码        │ ← 标题栏
├────────────────────────────────────────────────┤
│ # Python代码...              ▶️ 可运行         │ ← 代码内容
└────────────────────────────────────────────────┘
│ 💡 说明：此代码模拟预训练流程...               │ ← 说明
└────────────────────────────────────────────────┘
```

### 3. 📊 新增数据对比组件

创建了 **PretrainingVsSFTData** 组件，包含：

#### Part1 - 数据示例
✅ **预训练数据示例**（3个）
  - 维基百科文章片段
  - GitHub代码片段
  - 新闻文章
  - 每个都展示：原始文本、训练目标、损失计算

✅ **SFT数据示例**（3个）
  - 问答任务（instruction-input-response格式）
  - 文本摘要
  - 风格控制（客服助手）
  - 每个都展示：完整的三元组结构

✅ **同一输入的对比**
  - 展示"人工智能正在改变世界"这句话
  - 在预训练中：分词→每个位置预测下一个词
  - 在SFT中：作为response的一部分，只对response计算损失
  - 清晰对比两种训练方式的差异

### 4. 💻 Part1 页面增强

现在Part1包含：

| 内容类型 | 数量 | 说明 |
|---------|------|------|
| 代码示例引用 | 3个 | 都显示文件路径，可复制 |
| 数据对比示例 | 6个 | 预训练3个+SFT3个 |
| 可视化图表 | 5+ | 损失曲线、饼图、条形图等 |
| 类比说明 | 8+ | 形象生动的比喻 |
| 对比表格 | 2个 | 多维度详细对比 |

## 🚀 如何使用

### 查看代码示例

1. **在网页端**：
   - 浏览http://localhost:5173/part1
   - 看到代码块时，会显示文件路径：`📁 code/part1/xxx.py`
   - 点击"复制代码"按钮可复制
   - 查看说明了解代码用途

2. **运行代码**：
   ```bash
   # 安装依赖
   pip install -r code/requirements.txt
   
   # 运行Part1的代码
   python code/part1/01_pretraining_simulation.py
   python code/part1/02_sft_vs_pretraining.py
   python code/part1/03_data_scale_comparison.py
   ```

### 查看数据示例

访问Part1页面，滚动到"预训练数据 vs SFT数据：具体示例对比"部分：
- 📚 预训练数据示例（蓝色卡片）
- 🎯 SFT数据示例（紫色卡片）
- 🔬 同一输入的对比（橙色卡片）

每个示例都包含：
- 原始数据
- 训练目标
- 损失计算方式
- 学习到的能力

## 📝 代码文件说明

### Part1 代码

1. **01_pretraining_simulation.py**
   - 模拟预训练的完整流程
   - 展示如何预测下一个词
   - 计算训练损失
   - 查看损失下降过程

2. **02_sft_vs_pretraining.py**
   - 对比两种模型的表现
   - 同一个问题，不同的回答
   - 直观展示SFT的价值

3. **03_data_scale_comparison.py**
   - 数据规模量化对比
   - 生成可视化图表
   - 形象类比说明

### Part2 代码

1. **01_full_finetuning_problems.py**
   - 展示全量微调的三大问题
   - 计算内存需求
   - 模拟灾难性遗忘
   - 分析存储成本

2. **02_lora_mechanism.py**
   - 详细演示LoRA工作原理
   - 矩阵分解可视化
   - 参数量对比计算
   - 前向传播流程

## 🎯 待完成

- [ ] Part3 的代码示例（数据集相关）
- [ ] Part4 的代码示例（工作流相关）
- [ ] Part2/3/4 页面中添加代码引用
- [ ] 更多可视化图表
- [ ] 更多具体示例

## 📖 文档位置

- 代码总README：`code/README.md`
- Part1代码说明：`code/part1/README.md`
- 完整使用指南：`使用指南.md`
- 快速开始：`QUICKSTART.md`

## ✅ 已解决的问题

1. ✅ 代码文件路径在网页端清晰显示
2. ✅ 大量具体的数据示例（预训练和SFT）
3. ✅ 同一输入在两种训练中的差异对比
4. ✅ 损失计算的具体说明
5. ✅ 代码可以独立运行

## 🎉 效果预览

访问 http://localhost:5173/part1 可以看到：

1. **更丰富的可视化** - 图表、动画、对比
2. **具体的数据示例** - 不再只是抽象概念
3. **代码文件引用** - 每个概念都有对应代码
4. **详细的解释** - 每个示例都有说明

---

**现在可以启动系统查看效果！**

```bash
cd sft-theory
./start.sh
```

然后访问：http://localhost:5173/part1

